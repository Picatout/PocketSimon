MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ; NAME: PocketSimon
                      00002 ; DESC:  simon game implemented on a PIC10F202
                      00003 ; COPYRIGHT: jacques Deschenes, 2012,2016  
                      00004 ; LICENCE: GPLv3    
                      00005 ; DATE: 2012-03-05
                      00006 ; REVISION: 2016-12-31    
                      00007 ; VERSION: 1.1
                      00008 ; 
                      00009 ; GAME:  4 LEDs associated with 4 notes. A sequence of notes must be repeated by
                      00010 ; the player. At success a new note is appended at the end of sequence.
                      00011 ; After 6, 12, 18, 24 and 32 notes success a tune is played. The maximun length of
                      00012 ; sequence is 32 notes. A player that succeed to replay the full 32 notes sequence
                      00013 ; hear the complete victory tune after what the game start over.
                      00014 ; At end of each game the length of sequence is displayed.
                      00015 ; The display work like this:
                      00016 ;  BLUE LED is 25
                      00017 ;  YELLOW LED is 10
                      00018 ;  RED LED is 5
                      00019 ;  GREEN LED is 1
                      00020 ; length=NB*25+NY*10+NR*5+NG
                      00021 ;  where Nx is the number of blink for each color.    
                      00022 ; At first error the game is over and a MCU wait for a new set.
                      00023 ; At power on the MCU run a Power On Self Test, which consist of lighting 
                      00024 ; the 4 LEDs sequencially while sounding the associated note. 
                      00025 ; After POST the 4 LEDs light in loop until the player press a
                      00026 ; button to start game. 
                      00027 ;
                      00028 ; DESCRIPTION: the purpose of this project is to demonstrate the use of a single
                      00029 ; logic I/O to read many switches using a capacitor charging time.
                      00030 ; The game use 4 switches that are all connected  to a resistors ladder. The bottom
                      00031 ; of this ladder is connected to a capacitor and to the GP3 input. The time it take
                      00032 ; for this capacitor to charge to a logic 1 level depend on which button is pressed.    
                      00033 ; Four LEDs of different colour are connected to GP0 and GP1
                      00034 ; The audio output is to GP2
                      00035 ; a PNP small switching transistor is used to drive an 150 ohm speaker
                      00036 ; Another NPN small signal transistor is also connected GP2. This one is used
                      00037 ; to discharge the switches timing capacitor. As the 2 transistors are controlled by
                      00038 ; the same I/O as an inconvinience.    
                      00039 ; The inconvience of this design is that when reading buttons a noise is heard in speaker.
                      00040 ; I consider this to be a small inconvience.
                      00041 ; This design connect 2 LEDs in series from V+ to ground and consequently works only
                      00042 ; with a 3 volt power supply. For a voltage over 3 volt a permanent current path is
                      00043 ; formed through diodes GREEN, RED and YELLOW, BLUE and the LEDs are always ligthed.
                      00044 ; But with a 3 volt power supply it works fine because the conduction voltage of 2 LEDs
                      00045 ; in series in over 3 volts.
                      00046 ; see schematic for detail.
                      00047 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00048 ;This program is free software: you can redistribute it and/or modify
                      00049 ;    it under the terms of the GNU General Public License as published by
                      00050 ;    the Free Software Foundation, either version 3 of the License, or
                      00051 ;    (at your option) any later version.
                      00052 ;
                      00053 ;    This program is distributed in the hope that it will be useful,
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00054 ;    but WITHOUT ANY WARRANTY; without even the implied warranty of
                      00055 ;    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                      00056 ;    GNU General Public License for more details.
                      00057 ;
                      00058 ;    You should have received a copy of the GNU General Public License
                      00059 ;    along with this program.  If not, see <http://www.gnu.org/licenses/>.    
                      00060 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00061     
                      00062     include P10F202.INC
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Nov 17 2016
                      00005 ;  MPASM PIC10F202 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2016 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00151         LIST
                      00063     radix dec
                      00064     
0FFF   0FEB           00065     __config _MCLRE_OFF & _CP_OFF & _WDTE_OFF  ; Watchdog disabled
                      00066                                                ;'master clear' disabled
                      00067                                                ; no code protection
                      00068 
                      00069     errorlevel 2 ; warning disabled
                      00070 
                      00071 ;;;;;;    MCU option mask ;;;;;;;;;;;;;;;;;;;;
                      00072 #define OPTION_MASK B'01000001';bit7=0, wakeup on I/O change
                      00073                                ;bit6=1, pullup disabled
                      00074                                ;bit5=0, timer0 clock -> Fosc/4.
                      00075                                ;bit4=0, 
                      00076                                ;bti3=0, prescale on TIMER0
                      00077                                ;bit2-0=001, prescale 1:4
                      00078                                ;  TIMR0 increment every 4usec.
                      00079 
                      00080 
                      00081 
                      00082 #define RED_GREEN_TRIS   B'1001'
                      00083 #define YELLOW_BLUE_TRIS B'1010'
                      00084 #define RED_GPIO         B'1011'
                      00085 #define GREEN_GPIO       B'1001'
                      00086 #define YELLOW_GPIO      B'1010'
                      00087 #define BLUE_GPIO        B'1001'
                      00088 
                      00089 #define GREEN  0
                      00090 #define RED    1
                      00091 #define YELLOW 2
                      00092 #define BLUE   3
                      00093 
                      00094 #define BTN_GREEN  0
                      00095 #define BTN_RED    1
                      00096 #define BTN_YELLOW 2
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00097 #define BTN_BLUE   3
                      00098 #define BTN_NONE   4
                      00099 
                      00100 ; note for each color
                      00101 #define GREEN_NOTE   B'01000000'
                      00102 #define RED_NOTE B'01000101'
                      00103 #define YELLOW_NOTE    B'01001001'
                      00104 #define BLUE_NOTE  B'01001100'
                      00105 
                      00106 ; values for muical pauses
                      00107 #define THIRTY2TH B'10111111'
                      00108 #define SIXTEENTH B'10011111'
                      00109 #define HEIGHT    B'01111111'
                      00110 #define QUARTER   B'01011111'
                      00111 #define HALF      B'00111111'
                      00112 #define WHOLE     B'00011111'
                      00113 
                      00114 #define AUDIO  GPIO, GP2
                      00115 #define CLAMP GPIO, GP2
                      00116 
                      00117 ; charging time delay
                      00118 ; this is adjusted by testing
                      00119 ; It may vary due to components
                      00120 ; tolerance.
                      00121 ; When pressing RED button if
                      00122 ; GREEN LED turn on increase
                      00123 ; GRN_CNT value.
                      00124 ; On the contrary if YELLOW LED
                      00125 ; turn on decrease GRN_CNT value.                              
                      00126 #define GRN_CNT 32
                      00127 #define RED_CNT 2*GRN_CNT
                      00128 #define YEL_CNT 3*GRN_CNT
                      00129 #define BLUE_CNT 4*GRN_CNT
                      00130 #define TC_MAX 5*GRN_CNT
                      00131 
                      00132 ;;;;;;;;;;;;    MACROS  ;;;;;;;;;;;;;;;;;;;;;;
                      00133 
                      00134 
                      00135 led_off macro
                      00136  movlw B'1011'
                      00137  tris GPIO
                      00138  endm
                      00139 
                      00140 note_off macro
                      00141  bsf AUDIO
                      00142  endm
                      00143 
                      00144 note_on macro
                      00145  bcf AUDIO
                      00146  endm
                      00147 
                      00148 ; keep C3 capacitor discharged 
                      00149 clamp_on macro
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00150  bsf CLAMP
                      00151  endm
                      00152 
                      00153 ; enable C3 capacitor to charge. 
                      00154 clamp_off macro
                      00155  bcf CLAMP
                      00156  endm
                      00157 
                      00158 ; switch marco
                      00159 switch macro var ; put variable in W for use by following case
                      00160  movfw var
                      00161  endm
                      00162 
                      00163 case macro  n, address  ; go to address if W==n
                      00164  xorlw n
                      00165  skpnz
                      00166  goto address
                      00167  xorlw n ; reset W for next case
                      00168  endm
                      00169 
                      00170 ; load 16 bits variable with constant
                      00171 ; use conditional assembly to optimize size
                      00172 ; depending on constant value.
                      00173 ; resulting code size is between 2 and 4 instructions 
                      00174 loadr16 macro r16, n 
                      00175  local h,l
                      00176  h=high n
                      00177  l=low n
                      00178  if l==0
                      00179    clrf r16
                      00180  else
                      00181    movlw low n
                      00182    movwf r16
                      00183  endif
                      00184  if h==0
                      00185    clrf r16+1
                      00186  else
                      00187    movlw h
                      00188    movwf r16+1
                      00189  endif
                      00190  endm
                      00191 
                      00192 ;;;;;;;;;;;;;;;; VARIABLES  ;;;;;;;;;;;;;;;;;;;;;
                      00193     udata
0000                  00194   btn_down res 1  ; which button is down
0001                  00195   led res 1 ; active led value
0002                  00196   delay res 2 ; delay counter used by delay_ms subroutine.
0004                  00197   half_period res 1 ; note half-period delay
0005                  00198   timeout res 2 ; inactivity timeout
0007                  00199   cap_cnt res 1 ; capacitor charge time
0008                  00200   notes_cnt res 1 ; sequence length
0009                  00201   rand res 3 ; pseudo random number generator register
000C                  00202   tune_array res 8 ; note sequence array maximun 32 notes. 2 bits used per note.
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0014                  00203   t0 res 1 ; temporary storage
0015                  00204   t1 res 1 
0016                  00205   t2 res 1
0017                  00206   t3 res 1
                      00207 
                      00208 ; access to higher bytes of multibytes variables 
                      00209 #define delayH delay+1
                      00210 #define timeoutH timeout+1
                      00211 #define randH rand+1
                      00212 #define randU rand+2
                      00213  
                      00214   code 
                      00215 ;;;;;;;;;;;;;;;;;;; CODE SEGMENT ;;;;;;;;;;;;;;;;;;
                      00216     org 0
0000   0A??           00217  goto init
                      00218 
                      00219 ;;;;;;;;;;    delay_ms  ;;;;;;;;;;;;;;;;;;
                      00220 ; delay in miliseconds
                      00221 ; delay = value in msec
                      00222 
0001                  00223 delay_ms:
0001   0C07           00224  movlw .7
0002   0021           00225  movwf TMR0
0003   0201           00226  movfw TMR0
0004   0743           00227  skpz
0005   0A??           00228  goto $-2
0006   0C01           00229  movlw 1
0007   00??           00230  subwf delay,F
0008   0703           00231  skpc
0009   00??           00232  subwf delayH,F
000A   0603           00233  skpnc
000B   0A??           00234  goto delay_ms
000C   0800           00235  return
                      00236  
                      00237 ;translate button to corresponding note
000D                  00238 translate_table:
000D   01E2           00239  addwf PCL, F
000E   0840           00240  dt GREEN_NOTE
000F   0845           00241  dt RED_NOTE
0010   0849           00242  dt YELLOW_NOTE
0011   084C           00243  dt BLUE_NOTE
                      00244 
                      00245 ; tempered scale half-period values 
0012                  00246 note_table: 
0012   01E2           00247  addwf PCL, F
0013   08FE           00248  dt .254  ; G2     blue note (0)
0014   08F0           00249  dt .240  ; G#2
0015   08E2           00250  dt .226  ; A2
0016   08D6           00251  dt .214  ; A#2
0017   08C9           00252  dt .201  ; B2
0018   08BE           00253  dt .190  ; C3     yellow note (5)
0019   08B3           00254  dt .179  ; C#3
001A   08A9           00255  dt .169  ; D3
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001B   08A0           00256  dt .160  ; D#3
001C   0897           00257  dt .151  ; E3     red note (9)
001D   088E           00258  dt .142  ; F3
001E   0886           00259  dt .134  ; F#3
001F   087F           00260  dt .127  ; G3     green note (12)
0020   0877           00261  dt .119  ; G#3
0021   0871           00262  dt .113  ; A3
0022   086A           00263  dt .106  ; A#3
0023   0864           00264  dt .100  ; B3
0024   085F           00265  dt .95   ; C4
0025   0859           00266  dt .89   ; C#4
0026   0854           00267  dt .84   ; D4
0027   084F           00268  dt .79   ; D#4
0028   084B           00269  dt .75   ; E4
0029   0847           00270  dt .71   ; F4
002A   0843           00271  dt .67   ; F#4
002B   083F           00272  dt .63   ; G4
                      00273 
                      00274 ; rocky 1 movie theme 
002C                  00275 rocky_theme:
002C   01E2           00276  addwf PCL,F
002D   0889           00277  dt B'10001001' ; 16e
002E   086B           00278  dt B'01101011' ; 8g
002F   089F           00279  dt B'10011111' ; 16p
0030   082E           00280  dt B'00101110' ; 2a
0031   087F           00281  dt B'01111111' ; 8p
0032   088E           00282  dt B'10001110' ; 16a
0033   0870           00283  dt B'01110000' ; 8b
0034   089F           00284  dt B'10011111' ; 16p
0035   0829           00285  dt B'00101001' ; 2e
0036   089F           00286  dt B'10011111' ; 16p
0037   08BF           00287  dt B'10111111' ; 32p
0038   0889           00288  dt B'10001001' ; 16e
0039   086B           00289  dt B'01101011' ; 8g
003A   089F           00290  dt B'10011111' ; 16p
003B   082E           00291  dt B'00101110' ; 2a
003C   089F           00292  dt B'10011111' ; 16p
003D   08BF           00293  dt B'10111111' ; 32p
003E   088E           00294  dt B'10001110' ; 16a
003F   0870           00295  dt B'01110000' ; 8b
0040   089F           00296  dt B'10011111' ; 16p
0041   0809           00297  dt B'00001001' ; 1e
0042   087F           00298  dt B'01111111' ; 8p
0043   089F           00299  dt B'10011111' ; 16p
0044   0887           00300  dt B'10000111' ; 16d4
0045   0885           00301  dt B'10000101' ; 16c4
0046   0867           00302  dt B'01100111' ; 8d4
0047   089F           00303  dt B'10011111' ; 16p
0048   0891           00304  dt B'10010001' ; 16c5
0049   0893           00305  dt B'10010011' ; 16d5
004A   0855           00306  dt B'01010101' ; 4e5
004B   085F           00307  dt B'01011111' ; 4p
004C   0891           00308  dt B'10010001' ; 16c5
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

004D   0891           00309  dt B'10010001' ; 16c5
004E   0870           00310  dt B'01110000' ; 8b
004F   0890           00311  dt B'10010000' ; 16b
0050   086E           00312  dt B'01101110' ; 8a
0051   088E           00313  dt B'10001110' ; 16a
0052   084B           00314  dt B'01001011' ; 4g
0053   0876           00315  dt B'01110110' ; 8f5
0054   0815           00316  dt B'00010101' ; 1e5
                      00317 
                      00318 
                      00319 
                      00320 ; GPIO and TRIS values for each led
0055                  00321 led_gpio_table:
0055   01E2           00322  addwf PCL,F
0056   0899           00323  dt GREEN_GPIO + (RED_GREEN_TRIS<<4)
0057   089B           00324  dt RED_GPIO + (RED_GREEN_TRIS<<4)
0058   08AA           00325  dt YELLOW_GPIO + (YELLOW_BLUE_TRIS<<4)
0059   08A9           00326  dt BLUE_GPIO + (YELLOW_BLUE_TRIS<<4)
                      00327  
                      00328 ;;;;;;;  led_on  ;;;;;;;
                      00329 ;; light LED  
                      00330 ;; input: 
                      00331 ;;   variable 'led' 
                      00332 ;;   value is an index in led_gpio_table
                      00333 ;;;;;;;;;;;;;;;;;;;;;;;; 
005A                  00334 led_on:
005A   02??           00335  movfw led
005B   09??           00336  call led_gpio_table
005C   0026           00337  movwf GPIO
005D   0021           00338  movwf TMR0 ; use TMR0 as temporary storage
005E   0381           00339  swapf TMR0,W
005F   0006           00340  tris GPIO
0060   0800           00341  return
                      00342 
                      00343 
                      00344 ;;;;;;;;;;;;;;;;;  read_buttons ;;;;;;;;;;;
                      00345 ;; read GP3 
                      00346 ;; when GP3 == 1
                      00347 ;; compare  cap_cnt with threshold values to identify button
                      00348 ;; WORKING:
                      00349 ;;   first the clamp is released on 'C3'
                      00350 ;;   Capacitor start charging toward Vdd.
                      00351 ;;   Then variable 'cap_cnt' is incremented
                      00352 ;;   until GP3 read as '1'.
                      00353 ;;   The final value of 'cap_cnt' determine
                      00354 ;;   if a button is down and which one. 
                      00355 ;; output:
                      00356 ;;  btn_down variable
                      00357 ;;  Carry bit: 0 button down, 1 no button down 
                      00358 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 
0061                  00359 read_buttons:
0061   00??           00360   clrf btn_down
0062   00??           00361   clrf cap_cnt
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00362   clamp_off ; capacitor start charging.
0063   0446               M  bcf CLAMP
0064                  00363 rbtn1: ; charging time loop
0064   0666           00364   btfsc GPIO, GP3
0065   0A??           00365   goto rbtn3
0066   03??           00366   incfsz cap_cnt,F
0067   0A??           00367   goto rbtn1
0068   0C04           00368   movlw BTN_NONE ; charging time too long,
0069   00??           00369   movwf btn_down ; assume no button down.
006A   0503           00370   setc ; carry set at exit means no button down
006B   0A??           00371   goto rb_exit
006C                  00372 rbtn3: ; check cap_cnt value to identify button
006C   0C20           00373   movlw GRN_CNT
006D   00??           00374   subwf cap_cnt, W
006E   0703           00375   skpc
006F   0A??           00376   goto rb_exit  ; BTN_GREEN
0070   02??           00377   incf btn_down,F
0071   0C40           00378   movlw RED_CNT
0072   00??           00379   subwf cap_cnt, W
0073   0703           00380   skpc
0074   0A??           00381   goto rb_exit ; BTN_RED
0075   02??           00382   incf btn_down,F
0076   0C60           00383   movlw YEL_CNT
0077   00??           00384   subwf cap_cnt, W
0078   0703           00385   skpc
0079   0A??           00386   goto rb_exit ; BTN_YELLOW
007A   02??           00387   incf btn_down,F ; BTN_BLUE
007B   0C80           00388   movlw BLUE_CNT
007C   00??           00389   subwf cap_cnt,W
007D   0603           00390   skpnc
007E   02??           00391   incf btn_down,f ; BTN_NONE
007F                  00392 rb_exit:
                      00393   clamp_on
007F   0546               M  bsf CLAMP
0080   0800           00394   return 
                      00395 
                      00396 ;;;;;; store_note  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00397 ;;; store note in tune_array
                      00398 ;;; inputs:
                      00399 ;;;     t0= array index where to store note {0-31}
                      00400 ;;;     t1=note  {0-3} stored as 2 bits value.
                      00401 ;;; This one is a little tricky because each byte is split in 4 slots of
                      00402 ;;; 2 bits. The position in tune_array is index/4 and the slot is the remainder.  
                      00403 ;;; So there is 4 notes per byte. The note must be stored in the good slot without
                      00404 ;;; altering the contain of others slots.
                      00405 ;;;  bits:  76|54|32|10  
                      00406 ;;;  slots: s3|s2|s1|s0  
                      00407 ;;; To get that result a AND mask is create to reset the slot to 0 and the OR
                      00408 ;;; operation is used to insert the note in the slot.  
                      00409 ;;; exemple: say the index is 5 and the note is 1. then
                      00410 ;;; byte order is 6/4=1
                      00411 ;;; slot is 6 % 4 = 2
                      00412 ;;;  AND mask is 0b11001111
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00413 ;;                   ^^ slot 2 will be set to 0 after AND operation     
                      00414 ;;;  OR mask is  0b00010000 
                      00415 ;;;                  ^^  slot 2 will be set to 1 after OR operation
                      00416 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 
0081                  00417 store_note:
                      00418 ;initialize array pointer    
0081   0C??           00419  movlw tune_array
0082   0024           00420  movwf FSR
                      00421 ; FSR += index/4 
                      00422 ; clrc ; not needed because FSR is only 5 bits
0083   03??           00423  rrf t0,W
0084   00??           00424  movwf t2
                      00425 ; clrc  ; not need because FSR is only 5 bits
0085   03??           00426  rrf t2,W
0086   01E4           00427  addwf FSR,F ; now FSR point to byte in tune_array
                      00428 ; create AND mask and rotate note in right slot
0087   0CFC           00429  movlw 0xFC
0088   00??           00430  movwf t2 ; t2=AND mask
0089   0C03           00431  movlw 3
008A   01??           00432  andwf t1,F ; t1=note (ensure all bits are 0 except bits 0,1)
008B   01??           00433  andwf t0,F   ; t0 = slot number (index % 4 )
008C   0643           00434  skpnz
008D   0A??           00435  goto store_note02 ; no need to rotate
008E                  00436 store_note01: 
                      00437 ;; rotate left mask 1 slot 
008E   0503           00438  bsf STATUS,C
008F   03??           00439  rlf t2,F
0090   03??           00440  rlf t2,F
                      00441 ;; rotate left note 1 slot 
0091   0403           00442  clrc 
0092   03??           00443  rlf t1,F
0093   03??           00444  rlf t1,F
0094   02??           00445  decfsz t0,F
0095   0A??           00446  goto store_note01
0096                  00447 store_note02:
                      00448 ; the shifting is done, store note in slot. 
0096   02??           00449  movfw t2     ; apply AND mask
0097   0160           00450  andwf INDF,F ; to reset that slot to 0
0098   02??           00451  movfw t1     ; W=note
0099   0120           00452  iorwf INDF,F ; insert note in slot
009A   0800           00453  return
                      00454 
                      00455 ;;;;;;  load_note  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00456 ;;; get note from tune_array and put it in W 
                      00457 ;;; input: 
                      00458 ;;;      W is array index  {0-31}
                      00459 ;;; output: 
                      00460 ;;;      t1 note {0-3}
                      00461 ;;; byte_order is index/4
                      00462 ;;; slot is index % 4
                      00463 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 
009B                  00464 load_note:
009B   00??           00465  movwf t0 ; save index
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00466 ; set array pointer
009C   0C??           00467  movlw tune_array
009D   0024           00468  movwf FSR
                      00469 ; ignore carry in rrf because FSR is only 5 bits
                      00470 ; the addition won't be affected by bits 7:6 of W 
009E   03??           00471  rrf t0,W
009F   00??           00472  movwf t1
00A0   03??           00473  rrf t1,W
00A1   01E4           00474  addwf FSR,F ; FSR=tune_array+index/4
00A2   0200           00475  movfw INDF   ; get the byte containing the note slot
00A3   00??           00476  movwf t1 ; save it in t1
00A4   0C03           00477  movlw 3
00A5   01??           00478  andwf t0,F ; get slot
00A6   0643           00479  skpnz
00A7   0A??           00480  goto load_note02
                      00481 ; slot shifted right 1 position 
00A8                  00482 rotate_1slot_right:
00A8   03??           00483  rrf t1,F
00A9   03??           00484  rrf t1,F
00AA   02??           00485  decfsz t0,F
00AB   0A??           00486  goto rotate_1slot_right
00AC                  00487 load_note02:
00AC   01??           00488  andwf t1,F
00AD   0800           00489  return
                      00490 
                      00491 ;;;;;;;;;  random  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00492 ;; pseudo random number generator
                      00493 ;; 24 bits linear feedback shift register 
                      00494 ;; REF: http://en.wikipedia.org/wiki/Linear_feedback_shift_register
                      00495 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
00AE                  00496 random:  
00AE   0403           00497   clrc
00AF   03??           00498   rrf randU,F
00B0   03??           00499   rrf randH,F
00B1   03??           00500   rrf rand,F
00B2   0703           00501   skpc
00B3   0800           00502   return
00B4   0CE1           00503   movlw 0xE1
00B5   01??           00504   xorwf randU, F
00B6   0800           00505   return
                      00506 
                      00507 ;;;;;;;;;; wait_btn_release  ;;;;;
                      00508 ;; repeatedly read buttons until 
                      00509 ;; until it return BTN_NONE
                      00510 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  
00B7                  00511 wait_btn_release:
00B7   09??           00512  call read_buttons
00B8   0703           00513  skpc
00B9   0A??           00514  goto wait_btn_release
00BA   0800           00515  return
                      00516 
                      00517 
                      00518 ;;;;;;;;;;;;; note  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00519 ; play a musical note from tempered scale. 
                      00520 ; input:
                      00521 ;  w = note : encoding  bits 0-4 notes, note 0x1F=pause , bits 5-7 duration
                      00522 ; WORKING:
                      00523 ;  This subroutine is cycle counted.
                      00524 ;  Tones period are based on Tcy=1uSec
                      00525 ;  Each path in half-cycle loop is 10 Tcy.
                      00526 ;  Frequencies values are computed based on this 10 Tcy.
                      00527 ;  Any change on this code will alter the frequencies. 
                      00528 ;  timeout and delay form a 24 bits counter -> timeout:delayH:delay 
                      00529 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 
00BB                  00530 note:
00BB   00??           00531  movwf t0
                      00532  ; if note=0x1F it is a pause
00BC   0E1F           00533  andlw 0x1F
00BD   0F1F           00534  xorlw 0x1F
00BE   0643           00535  skpnz
00BF   0A??           00536  goto pause
                      00537 ; maximum duration (whole note)=0x30d40 ~2 seconds 
                      00538  loadr16 delay, 0x0D40
  0000                    M  local h,l
  0000000D                M  h=high 0x0D40
  00000040                M  l=low 0x0D40
                          M  if l==0
                          M    clrf delay
                          M  else
00C0   0C40               M    movlw low 0x0D40
00C1   00??               M    movwf delay
                          M  endif
                          M  if h==0
                          M    clrf delay+1
                          M  else
00C2   0C0D               M    movlw h
00C3   00??               M    movwf delay+1
                          M  endif
00C4   0C03           00539  movlw 3
00C5   00??           00540  movwf timeout
00C6   03??           00541  swapf t0,W
00C7   00??           00542  movwf t1
00C8   03??           00543  rrf t1,F
00C9   0C07           00544  movlw 0x7
00CA   01??           00545  andwf t1,F
00CB   0643           00546  skpnz
00CC   0A??           00547  goto note02
                      00548 ; divide duration counter by 2 for each count in t1
                      00549 ; to get note duration 
00CD                  00550 note01:
00CD   0403           00551  clrc
00CE   03??           00552  rrf timeout
00CF   03??           00553  rrf delayH,F
00D0   03??           00554  rrf delay,F
00D1   02??           00555  decfsz t1
00D2   0A??           00556  goto note01
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00D3                  00557 note02:
00D3   0C1F           00558  movlw 0x1F
00D4   01??           00559  andwf t0,W ; note index in table
00D5   09??           00560  call note_table
00D6   00??           00561  movwf half_period
                      00562 ; tone generation loop
                      00563 ; WARNING: cycle counted 
                      00564 ; values in note_table depends on 
                      00565 ; the number of cycles in this loop 
00D7                  00566 note1: ; half-period loop
00D7   0C04           00567  movlw B'0100'  ; 
00D8   01A6           00568  xorwf GPIO, F  ; toggle output pin
00D9   02??           00569  movfw half_period ; 
00DA   00??           00570  movwf t0 ; 
00DB   0C01           00571  movlw 1  ; ovherhead 5 TCY
00DC                  00572 note2: ; duration loop
00DC   00??           00573  subwf delay,F ; 1 TCY
00DD   0703           00574  skpc  ; 2|3 TCY
00DE   00??           00575  subwf delayH,F ; 3 TCY 
00DF   0703           00576  skpc ; 4|5 TCY
00E0   00??           00577  subwf timeout,F ; 5 TCY
00E1   0703           00578  skpc ; 6|7 TCY
00E2   0A??           00579  goto note5
00E3   02??           00580  decfsz t0 ; 8|9 TCY
00E4   0A??           00581  goto note2  ; 10 TCY half-cycle loop
00E5   0A??           00582  goto note1 ; 16 TCY complete half-cycle
00E6                  00583 note5:
                      00584  clamp_on
00E6   0546               M  bsf CLAMP
00E7   0800           00585  return
                      00586 
                      00587 ;;;;; musical pause ;;;;;;;;;;;;;;
                      00588 ;; when note value is 0x1F
                      00589 ;; tone subroutine branch here.
                      00590 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 
00E8                  00591 pause: ;musical pause
                      00592  loadr16 delay, 2000
  0000                    M  local h,l
  00000007                M  h=high 2000
  000000D0                M  l=low 2000
                          M  if l==0
                          M    clrf delay
                          M  else
00E8   0CD0               M    movlw low 2000
00E9   00??               M    movwf delay
                          M  endif
                          M  if h==0
                          M    clrf delay+1
                          M  else
00EA   0C07               M    movlw h
00EB   00??               M    movwf delay+1
                          M  endif
00EC   03??           00593  swapf t0,F
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00ED   03??           00594  rrf t0,F
00EE   0C07           00595  movlw 0x7
00EF   01??           00596  andwf t0,F
00F0   0643           00597  skpnz
00F1   0A??           00598  goto pause01
                      00599 ; divide delay by 2 for each count in t0 
00F2                  00600 pause00: 
00F2   0403           00601  clrc
00F3   03??           00602  rrf delayH,F
00F4   03??           00603  rrf delay,F
00F5   02??           00604  decfsz t0,F
00F6   0A??           00605  goto pause00
00F7                  00606 pause01: 
00F7   09??           00607  call delay_ms
00F8   0800           00608  return
                      00609 
                      00610 
                      00611     
                      00612 ;;;;;;;;;;;;;;;  INITIALIZATION CODE ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00613  ; hardware initialization
00F9                  00614 init:
00F9   0C41           00615  movlw OPTION_MASK
00FA   0002           00616  option 
                      00617  led_off
00FB   0C0B               M  movlw B'1011'
00FC   0006               M  tris GPIO
00FD   0CA5           00618  movlw 0xA5
00FE   00??           00619  movwf rand
                      00620  clamp_on
00FF   0546               M  bsf CLAMP
0100                  00621 next_set:
0100   00??           00622  clrf led
0101   00??           00623  clrf notes_cnt
                      00624 
                      00625 ;;;;;;;;;;;;;;;;;;;;;;;;  MAIN PROCEDURE  ;;;;;;;;;;;;;;;;;;;;;
                      00626 ; The largest chunk of the code is here
                      00627 ; because subroutine calls are limited to 2 levels
                      00628 ; it use a lot of goto instead of call.
                      00629 ; I like to factor code in many subroutines that neast each others
                      00630 ; but this is not possible with this MCU.
                      00631 ; Here is spaghetti code for your degustation (or disgustation), MCU obliged. 
                      00632 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 
0102                  00633 main:
                      00634 ;;;;;;;;;;;;;;;;;;;;;;;;
                      00635 ;; power on self test
                      00636 ;; light each LED in sequence
                      00637 ;; with associated tone.
                      00638 ;; wait button down to start game    
                      00639 ;;;;;;;;;;;;;;;;;;;;;;;; 
0102                  00640 post:
0102   09??           00641  call led_on
0103   02??           00642  movfw led
0104   09??           00643  call translate_table ; get note binded to that LED
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0105   09??           00644  call note
                      00645  led_off
0106   0C0B               M  movlw B'1011'
0107   0006               M  tris GPIO
0108   02??           00646  incf led,F
0109   0C03           00647  movlw 3
010A   01??           00648  andwf led,F
010B   09??           00649  call read_buttons
010C   0603           00650  skpnc
010D   0A??           00651  goto post
010E   0201           00652  movfw TMR0
010F   00??           00653  movwf randH
0110   09??           00654  call wait_btn_release
                      00655  loadr16 delay, 500
  0000                    M  local h,l
  00000001                M  h=high 500
  000000F4                M  l=low 500
                          M  if l==0
                          M    clrf delay
                          M  else
0111   0CF4               M    movlw low 500
0112   00??               M    movwf delay
                          M  endif
                          M  if h==0
                          M    clrf delay+1
                          M  else
0113   0C01               M    movlw h
0114   00??               M    movwf delay+1
                          M  endif
0115   09??           00656  call delay_ms
                      00657 ; game loop.
0116                  00658 play_rand:
0116   02??           00659  movfw notes_cnt
0117   00??           00660  movwf t0
0118   02??           00661  incf notes_cnt,F
                      00662 ; add a random value to sequence 
0119   09??           00663  call random
011A   02??           00664  movfw randU
011B   01??           00665  xorwf randH,W
011C   01??           00666  xorwf rand,W
011D   0E03           00667  andlw 3
011E   00??           00668  movwf t1
011F   09??           00669  call store_note
                      00670 ; play sequence loop 
0120   00??           00671  clrf t3 ; notes counter
0121                  00672 play_rand02:
0121   02??           00673  movfw t3
0122   09??           00674  call load_note
0123   02??           00675  movfw t1
0124   00??           00676  movwf led
0125   09??           00677  call led_on
0126   02??           00678  movfw led
0127   09??           00679  call translate_table
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0128   09??           00680  call note
                      00681  led_off
0129   0C0B               M  movlw B'1011'
012A   0006               M  tris GPIO
                      00682  loadr16 delay, .100
  0000                    M  local h,l
  00000000                M  h=high .100
  00000064                M  l=low .100
                          M  if l==0
                          M    clrf delay
                          M  else
012B   0C64               M    movlw low .100
012C   00??               M    movwf delay
                          M  endif
                          M  if h==0
012D   00??               M    clrf delay+1
                          M  else
                          M    movlw h
                          M    movwf delay+1
                          M  endif
012E   09??           00683  call delay_ms ; 1/10 second pause
012F   02??           00684  incf t3,F
0130   02??           00685  movfw notes_cnt
0131   00??           00686  subwf t3,W
0132   0743           00687  skpz
0133   0A??           00688  goto play_rand02
                      00689 ; wait player playing sequence back
0134                  00690 wait_playback:
0134   00??           00691  clrf t3 ; notes counter
0135                  00692 wait01:
0135   0CFA           00693  movlw 250   ; maximun delay between each button 250 msec.
0136   00??           00694  movwf timeout
0137                  00695 wait02: ; wait button loop
                      00696  loadr16 delay, 20
  0000                    M  local h,l
  00000000                M  h=high 20
  00000014                M  l=low 20
                          M  if l==0
                          M    clrf delay
                          M  else
0137   0C14               M    movlw low 20
0138   00??               M    movwf delay
                          M  endif
                          M  if h==0
0139   00??               M    clrf delay+1
                          M  else
                          M    movlw h
                          M    movwf delay+1
                          M  endif
013A   09??           00697  call delay_ms
013B   02??           00698  movfw timeout
                      00699 ; movwf rand
013C   00??           00700  decf timeout,F
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

013D   0643           00701  skpnz
013E   0A??           00702  goto game_over
013F   09??           00703  call read_buttons
0140   0603           00704  skpnc 
0141   0A??           00705  goto wait02
                      00706  loadr16 delay, 10  ; wait 10 msec for buttons
  0000                    M  local h,l
  00000000                M  h=high 10
  0000000A                M  l=low 10
                          M  if l==0
                          M    clrf delay
                          M  else
0142   0C0A               M    movlw low 10
0143   00??               M    movwf delay
                          M  endif
                          M  if h==0
0144   00??               M    clrf delay+1
                          M  else
                          M    movlw h
                          M    movwf delay+1
                          M  endif
0145   09??           00707  call delay_ms      ; debouncing
0146   09??           00708  call read_buttons
0147   0603           00709  skpnc
0148   0A??           00710  goto wait01 ; no button down
                      00711 ; light LED and play tone corresponding to that button
0149   02??           00712  movfw btn_down
014A   00??           00713  movwf led
014B   09??           00714  call led_on
014C   02??           00715  movfw led
014D   09??           00716  call translate_table
014E   09??           00717  call note
                      00718  led_off
014F   0C0B               M  movlw B'1011'
0150   0006               M  tris GPIO
0151   09??           00719  call wait_btn_release
0152   02??           00720  movfw t3
0153   09??           00721  call load_note
0154   02??           00722  movfw t1
0155   01??           00723  xorwf led,W
0156   0743           00724  skpz
0157   0A??           00725  goto game_over ; not the good one
0158   02??           00726  incf t3,F
0159   02??           00727  movfw notes_cnt
015A   00??           00728  subwf t3,W
015B   0743           00729  skpz
015C   0A??           00730  goto wait01 ; loop to wait for next button
                      00731 ;playback_success
                      00732 ; to understand this 'switch' and 'case'
                      00733 ; machanism see macros above. 
                      00734  switch notes_cnt
015D   02??               M  movfw notes_cnt
                      00735  case 6, victory
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

015E   0F06               M  xorlw 6
015F   0643               M  skpnz
0160   0A??               M  goto victory
0161   0F06               M  xorlw 6 ; reset W for next case
                      00736  case 12, victory
0162   0F0C               M  xorlw 12
0163   0643               M  skpnz
0164   0A??               M  goto victory
0165   0F0C               M  xorlw 12 ; reset W for next case
                      00737  case 18, victory
0166   0F12               M  xorlw 18
0167   0643               M  skpnz
0168   0A??               M  goto victory
0169   0F12               M  xorlw 18 ; reset W for next case
                      00738  case 24, victory
016A   0F18               M  xorlw 24
016B   0643               M  skpnz
016C   0A??               M  goto victory
016D   0F18               M  xorlw 24 ; reset W for next case
                      00739  ;case 32, victory_final
016E   0F20           00740  xorlw 32
016F   0643           00741  skpnz
0170   0A??           00742  goto victory_final
                      00743 ; this is the default case 
                      00744  loadr16 delay, 500
  0000                    M  local h,l
  00000001                M  h=high 500
  000000F4                M  l=low 500
                          M  if l==0
                          M    clrf delay
                          M  else
0171   0CF4               M    movlw low 500
0172   00??               M    movwf delay
                          M  endif
                          M  if h==0
                          M    clrf delay+1
                          M  else
0173   0C01               M    movlw h
0174   00??               M    movwf delay+1
                          M  endif
0175   09??           00745  call delay_ms
0176   0A??           00746  goto play_rand
                      00747 ; play rocky_theme at 6,12,18,24 and 32 length success.
                      00748 ; more notes of the theme are played at each milestone.
                      00749 ; If player get at maximum sequence length (32)
                      00750 ; the theme is played to end. 
0177                  00751 victory_final:
0177   0C28           00752  movlw 40
0178   00??           00753  movwf notes_cnt
0179                  00754 victory:
0179   02??           00755  movfw notes_cnt
017A                  00756 play_victory_theme:
017A   00??           00757  movwf t2
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

017B   00??           00758  clrf t3
017C                  00759 prt01:
017C   02??           00760  movfw t3
017D   09??           00761  call rocky_theme
017E   09??           00762  call note
017F   02??           00763  incf t3,F
0180   02??           00764  movfw t2
0181   00??           00765  subwf t3,W
0182   0743           00766  skpz
0183   0A??           00767  goto prt01
                      00768  loadr16 delay, 0x400
  0000                    M  local h,l
  00000004                M  h=high 0x400
  00000000                M  l=low 0x400
                          M  if l==0
0184   00??               M    clrf delay
                          M  else
                          M    movlw low 0x400
                          M    movwf delay
                          M  endif
                          M  if h==0
                          M    clrf delay+1
                          M  else
0185   0C04               M    movlw h
0186   00??               M    movwf delay+1
                          M  endif
0187   09??           00769  call delay_ms
0188   0C28           00770  movlw 40
0189   01??           00771  xorwf notes_cnt,W
018A   0743           00772  skpz
018B   0A??           00773  goto play_rand
018C   0A??           00774  goto next_set
                      00775 ; player failed to repeat sequence
018D                  00776 game_over:
018D   0C38           00777  movlw B'00111000'
018E   09??           00778  call note ; audio alert game over
                      00779 ;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00780 ;; display sequence length
                      00781 ;; BLUE is 25
                      00782 ;; YELLOW is 10
                      00783 ;; RED is 5
                      00784 ;; GREEN is 1
                      00785 ;; length=NB*25+NY*10+NR*5+NG
                      00786 ;; where Nx is number of blink of
                      00787 ;; each LED.
                      00788 ;;;;;;;;;;;;;;;;;;;;;;;;;;; 
                      00789 #define len notes_cnt
018F   00??           00790  decf len,F
0190                  00791 display_length:
0190   02??           00792  movf len,F
0191   0643           00793  skpnz
0192   0A??           00794  goto wait1sec
0193   0C03           00795  movlw 3
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0194   00??           00796  movwf led
0195   0C19           00797  movlw .25
0196   00??           00798  subwf len,W
0197   0703           00799  skpc
0198   0A??           00800  goto lt25 ; <25
0199   00??           00801  movwf len
019A   0A??           00802  goto blink_led
019B                  00803 lt25:
019B   00??           00804  decf led,F
019C   0C0A           00805  movlw .10
019D   00??           00806  subwf len,W
019E   0703           00807  skpc
019F   0A??           00808  goto lt10; <10
01A0   00??           00809  movwf len
01A1   0A??           00810  goto blink_led
01A2                  00811 lt10:
01A2   00??           00812  decf led,F
01A3   0C05           00813  movlw .5
01A4   00??           00814  subwf len,W
01A5   0703           00815  skpc
01A6   0A??           00816  goto lt5 ; <5
01A7   00??           00817  movwf len
01A8   0A??           00818  goto blink_led
01A9                  00819 lt5:
01A9   00??           00820  decf led,F
01AA   00??           00821  decf len,F
01AB                  00822 blink_led:
01AB   09??           00823  call led_on
                      00824  loadr16 delay, 500
  0000                    M  local h,l
  00000001                M  h=high 500
  000000F4                M  l=low 500
                          M  if l==0
                          M    clrf delay
                          M  else
01AC   0CF4               M    movlw low 500
01AD   00??               M    movwf delay
                          M  endif
                          M  if h==0
                          M    clrf delay+1
                          M  else
01AE   0C01               M    movlw h
01AF   00??               M    movwf delay+1
                          M  endif
01B0   09??           00825  call delay_ms ; 500 msec pause
                      00826  led_off
01B1   0C0B               M  movlw B'1011'
01B2   0006               M  tris GPIO
                      00827  loadr16 delay, 500
  0000                    M  local h,l
  00000001                M  h=high 500
  000000F4                M  l=low 500
                          M  if l==0
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M    clrf delay
                          M  else
01B3   0CF4               M    movlw low 500
01B4   00??               M    movwf delay
                          M  endif
                          M  if h==0
                          M    clrf delay+1
                          M  else
01B5   0C01               M    movlw h
01B6   00??               M    movwf delay+1
                          M  endif
01B7   09??           00828  call delay_ms ; 500 msec pause
01B8   0A??           00829  goto display_length
                      00830 ;wait 1 second before resuming
                      00831 ;to next_set 
01B9                  00832 wait1sec:
                      00833  loadr16 delay, 1000
  0000                    M  local h,l
  00000003                M  h=high 1000
  000000E8                M  l=low 1000
                          M  if l==0
                          M    clrf delay
                          M  else
01B9   0CE8               M    movlw low 1000
01BA   00??               M    movwf delay
                          M  endif
                          M  if h==0
                          M    clrf delay+1
                          M  else
01BB   0C03               M    movlw h
01BC   00??               M    movwf delay+1
                          M  endif
01BD   09??           00834  call delay_ms
01BE   0A??           00835  goto next_set
                      00836  
0FEB                  00837  end
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 21


SYMBOL TABLE
  LABEL                             VALUE 

AUDIO                             GPIO, GP2
BLUE                              3
BLUE_CNT                          4*GRN_CNT
BLUE_GPIO                         B'1001'
BLUE_NOTE                         B'01001100'
BTN_BLUE                          3
BTN_GREEN                         0
BTN_NONE                          4
BTN_RED                           1
BTN_YELLOW                        2
C                                 00000000
CAL0                              00000001
CAL1                              00000002
CAL2                              00000003
CAL3                              00000004
CAL4                              00000005
CAL5                              00000006
CAL6                              00000007
CLAMP                             GPIO, GP2
DC                                00000001
F                                 00000001
FOSC4                             00000000
FSR                               00000004
GP0                               00000000
GP1                               00000001
GP2                               00000002
GP3                               00000003
GPIO                              00000006
GPWUF                             00000007
GREEN                             0
GREEN_GPIO                        B'1001'
GREEN_NOTE                        B'01000000'
GRN_CNT                           32
HALF                              B'00111111'
HEIGHT                            B'01111111'
INDF                              00000000
NOT_GPPU                          00000006
NOT_GPWU                          00000007
NOT_PD                            00000003
NOT_TO                            00000004
OPTION_MASK                       B'01000001'
OSCCAL                            00000005
PCL                               00000002
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
QUARTER                           B'01011111'
RED                               1
RED_CNT                           2*GRN_CNT
RED_GPIO                          B'1011'
RED_GREEN_TRIS                    B'1001'
RED_NOTE                          B'01000101'
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 22


SYMBOL TABLE
  LABEL                             VALUE 

SIXTEENTH                         B'10011111'
STATUS                            00000003
T0CS                              00000005
T0SE                              00000004
TC_MAX                            5*GRN_CNT
THIRTY2TH                         B'10111111'
TMR0                              00000001
TRISIO0                           00000000
TRISIO1                           00000001
TRISIO2                           00000002
TRISIO3                           00000003
W                                 00000000
WHOLE                             B'00011111'
YELLOW                            2
YELLOW_BLUE_TRIS                  B'1010'
YELLOW_GPIO                       B'1010'
YELLOW_NOTE                       B'01001001'
YEL_CNT                           3*GRN_CNT
Z                                 00000002
_.org_0_0005                      00000005
_CONFIG                           00000FFF
_CP_OFF                           00000FFF
_CP_ON                            00000FF7
_IDLOC0                           00000200
_IDLOC1                           00000201
_IDLOC2                           00000202
_IDLOC3                           00000203
_IntRC_OSC                        00000FFF
_MCLRE_OFF                        00000FEF
_MCLRE_ON                         00000FFF
_OSC_IntRC                        00000FFF
_WDTE_OFF                         00000FFB
_WDTE_ON                          00000FFF
_WDT_OFF                          00000FFB
_WDT_ON                           00000FFF
__10F202                          00000001
blink_led                         000001AB
btn_down                          00000000
cap_cnt                           00000007
case                              
clamp_off                         
clamp_on                          
delay                             00000002
delayH                            delay+1
delay_ms                          00000001
display_length                    00000190
game_over                         0000018D
half_period                       00000004
init                              000000F9
led                               00000001
led_gpio_table                    00000055
led_off                           
led_on                            0000005A
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 23


SYMBOL TABLE
  LABEL                             VALUE 

len                               notes_cnt
load_note                         0000009B
load_note02                       000000AC
loadr16                           
lt10                              000001A2
lt25                              0000019B
lt5                               000001A9
main                              00000102
next_set                          00000100
note                              000000BB
note01                            000000CD
note02                            000000D3
note1                             000000D7
note2                             000000DC
note5                             000000E6
note_off                          
note_on                           
note_table                        00000012
notes_cnt                         00000008
pause                             000000E8
pause00                           000000F2
pause01                           000000F7
play_rand                         00000116
play_rand02                       00000121
play_victory_theme                0000017A
post                              00000102
prt01                             0000017C
rand                              00000009
randH                             rand+1
randU                             rand+2
random                            000000AE
rb_exit                           0000007F
rbtn1                             00000064
rbtn3                             0000006C
read_buttons                      00000061
rocky_theme                       0000002C
rotate_1slot_right                000000A8
store_note                        00000081
store_note01                      0000008E
store_note02                      00000096
switch                            
t0                                00000014
t1                                00000015
t2                                00000016
t3                                00000017
timeout                           00000005
timeoutH                          timeout+1
translate_table                   0000000D
tune_array                        0000000C
victory                           00000179
victory_final                     00000177
wait01                            00000135
wait02                            00000137
MPASM 5.71                   POCKETSIMON.ASM   1-5-2017  11:59:47         PAGE 24


SYMBOL TABLE
  LABEL                             VALUE 

wait1sec                          000001B9
wait_btn_release                  000000B7
wait_playback                     00000134

Errors   :     0
Warnings :     0 reported,    45 suppressed
Messages :     0 reported,     3 suppressed

